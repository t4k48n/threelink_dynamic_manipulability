type point_t = Point of float * float
type angle_t = Angle of float * float * float
type unc_t = Unc of float * float * float * float * float * float * float * float * float * float
type mat_t =
  | M33 of float * float * float * float * float * float * float * float * float
  | M23 of float * float * float * float * float * float
  | M32 of float * float * float * float * float * float
  | M22 of float * float * float * float

let trans_mat m = match m with
  | M33 (m11, m12, m13, m21, m22, m23, m31, m32, m33) ->
      M33 (m11, m21, m31, m12, m22, m32, m13, m23, m33)
  | M23 (m11, m12, m13, m21, m22, m23) ->
      M32 (m11, m21, m12, m22, m13, m23)
  | M32 (m11, m21, m31, m12, m22, m32) ->
      M23 (m11, m21, m31, m12, m22, m32)
  | M22 (m11, m12, m21, m22) ->
      M22 (m11, m21, m12, m22)

let eq_mat m n = match (m, n) with
  | (M33 (m11, m12, m13, m21, m22, m23, m31, m32, m33),
     M33 (n11, n12, n13, n21, n22, n23, n31, n32, n33)) ->
        m11 = n11
          && m12 = n12
          && m13 = n13
          && m21 = n21
          && m22 = n22
          && m23 = n23
          && m31 = n31
          && m32 = n32
          && m33 = n33
  | (M23 (m11, m12, m13, m21, m22, m23),
     M23 (n11, n12, n13, n21, n22, n23)) ->
        m11 = n11
          && m12 = n12
          && m13 = n13
          && m21 = n21
          && m22 = n22
          && m23 = n23
  | (M32 (m11, m21, m31, m12, m22, m32),
     M32 (n11, n21, n31, n12, n22, n32)) ->
        m11 = n11
          && m12 = n12
          && m21 = n21
          && m22 = n22
          && m31 = n31
          && m32 = n32
  | (M22 (m11, m12, m21, m22),
     M22 (n11, n12, n21, n22)) ->
        m11 = n11
          && m12 = n12
          && m21 = n21
          && m22 = n22
  | _, _ -> failwith "shapes not matched"

let inv_mat m =
  match m with
    | M33 (m11, m12, m13, m21, m22, m23, m31, m32, m33) ->
        let mi11 = (m11*.m22*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) -. (-.m12*.(m11*.m23 -. m13*.m21) +. m13*.(m11*.m22 -. m12*.m21))*.(m21*.(m11*.m32 -. m12*.m31) -. m31*.(m11*.m22 -. m12*.m21)))/.(m11*.(m11*.m22 -. m12*.m21)*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31))) in
        let mi12 = (-.m11*.m12*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) +. m11*.(m11*.m32 -. m12*.m31)*.(-.m12*.(m11*.m23 -. m13*.m21) +. m13*.(m11*.m22 -. m12*.m21)))/.(m11*.(m11*.m22 -. m12*.m21)*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31))) in
        let mi13 = -.(-.m12*.(m11*.m23 -. m13*.m21) +. m13*.(m11*.m22 -. m12*.m21))/.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) in
        let mi21 = (-.m21*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) -. (m11*.m23 -. m13*.m21)*.(m21*.(m11*.m32 -. m12*.m31) -. m31*.(m11*.m22 -. m12*.m21)))/.((m11*.m22 -. m12*.m21)*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31))) in
        let mi22 = (m11*.(m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31) +. m11*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)))/.((m11*.m22 -. m12*.m21)*.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31))) in
        let mi23 = -.m11*.(m11*.m23 -. m13*.m21)/.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) in
        let mi31 = (m21*.(m11*.m32 -. m12*.m31) -. m31*.(m11*.m22 -. m12*.m21))/.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) in
        let mi32 = -.m11*.(m11*.m32 -. m12*.m31)/.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) in
        let mi33 = m11*.(m11*.m22 -. m12*.m21)/.((m11*.m22 -. m12*.m21)*.(m11*.m33 -. m13*.m31) -. (m11*.m23 -. m13*.m21)*.(m11*.m32 -. m12*.m31)) in
        M33 (mi11, mi12, mi13, mi21, mi22, mi23, mi31, mi32, mi33)
    | _ -> failwith "not implemented"

let det_mat m = match m with
  | M22 (m11, m21, m12, m22) ->
      m11 *. m22 -. m12 *. m21
  | _ -> failwith "not implemented"

let matmul_mat m n = match (m, n) with
  | (M33 (m11, m12, m13, m21, m22, m23, m31, m32, m33),
     M33 (n11, n12, n13, n21, n22, n23, n31, n32, n33)) ->
        M33 (m11 *. n11 +. m12 *. n21 +. m13 *. n31,
             m11 *. n12 +. m12 *. n22 +. m13 *. n32,
             m11 *. n13 +. m12 *. n23 +. m13 *. n33,
             m21 *. n11 +. m22 *. n21 +. m23 *. n31,
             m21 *. n12 +. m22 *. n22 +. m23 *. n32,
             m21 *. n13 +. m22 *. n23 +. m23 *. n33,
             m31 *. n11 +. m32 *. n21 +. m33 *. n31,
             m31 *. n12 +. m32 *. n22 +. m33 *. n32,
             m31 *. n13 +. m32 *. n23 +. m33 *. n33)
  | (M23 (m11, m12, m13, m21, m22, m23),
     M33 (n11, n12, n13, n21, n22, n23, n31, n32, n33)) ->
        M23 (m11 *. n11 +. m12 *. n21 +. m13 *. n31,
             m11 *. n12 +. m12 *. n22 +. m13 *. n32,
             m11 *. n13 +. m12 *. n23 +. m13 *. n33,
             m21 *. n11 +. m22 *. n21 +. m23 *. n31,
             m21 *. n12 +. m22 *. n22 +. m23 *. n32,
             m21 *. n13 +. m22 *. n23 +. m23 *. n33)
  | (M33 (m11, m12, m13, m21, m22, m23, m31, m32, m33),
     M32 (n11, n12, n21, n22, n31, n32)) ->
        M32 (m11 *. n11 +. m12 *. n21 +. m13 *. n31,
             m11 *. n12 +. m12 *. n22 +. m13 *. n32,
             m21 *. n11 +. m22 *. n21 +. m23 *. n31,
             m21 *. n12 +. m22 *. n22 +. m23 *. n32,
             m31 *. n11 +. m32 *. n21 +. m33 *. n31,
             m31 *. n12 +. m32 *. n22 +. m33 *. n32)
  | (M23 (m11, m12, m13, m21, m22, m23),
     M32 (n11, n12, n21, n22, n31, n32)) ->
        M22 (m11 *. n11 +. m12 *. n21 +. m13 *. n31,
             m11 *. n12 +. m12 *. n22 +. m13 *. n32,
             m21 *. n11 +. m22 *. n21 +. m23 *. n31,
             m21 *. n12 +. m22 *. n22 +. m23 *. n32)
  | _, _ -> failwith "not implemented"

let l1 = 1.0
let l2 = 1.0
let l3 = 1.0
let dl1 = 0.1
let dl2 = 0.1
let dl3 = 0.1

let dq1 = 0.1
let dq2 = 0.1
let dq3 = 0.1

let m1 = 1.0
let m2 = 1.0
let m3 = 1.0
let m4 = 1.0
let dm1 = 0.1
let dm2 = 0.1
let dm3 = 0.1
let dm4 = 0.1

let endpoint q z =
  let Angle (q1, q2, q3) = q in
  let Unc (z1, z2, z3, z4, z5, z6, _, _, _, _) = z in
  let l1_ = l1 +. dl1 *. z1 in
  let l2_ = l2 +. dl2 *. z2 in
  let l3_ = l3 +. dl3 *. z3 in
  let q1_ = q1 +. dq1 *. z4 in
  let q2_ = q2 +. dq2 *. z5 in
  let q3_ = q3 +. dq3 *. z6 in
  let x =
    l1_ *. cos(q1_) +. l2_ *. cos(q1_ +. q2_) +. l3_ *. cos(q1_ +. q2_ +. q3_) in
  let y =
    l1_ *. sin(q1_) +. l2_ *. sin(q1_ +. q2_) +. l3_ *. sin(q1_ +. q2_ +. q3_) in
  Point (x, y)

let jacobian_matrix q z =
  let Angle (q1, q2, q3) = q in
  let Unc (z1, z2, z3, z4, z5, z6, _, _, _, _) = z in
  let j11 = -.(dl1*.z1 +. l1)*.sin(dq1*.z4 +. q1) -. (dl2*.z2 +. l2)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) -. (dl3*.z3 +. l3)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) in
  let j12 = -.(dl2*.z2 +. l2)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) -. (dl3*.z3 +. l3)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) in
  let j13 = -.(dl3*.z3 +. l3)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) in
  let j21 = (dl1*.z1 +. l1)*.cos(dq1*.z4 +. q1) +. (dl2*.z2 +. l2)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. (dl3*.z3 +. l3)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) in
  let j22 = (dl2*.z2 +. l2)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. (dl3*.z3 +. l3)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) in
  let j23 = (dl3*.z3 +. l3)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) in
  M23 (j11, j12, j13, j21, j22, j23)

let inertia_matrix q z =
  let Angle (q1, q2, q3) = q in
  let Unc (z1, z2, z3, z4, z5, z6, z7, z8, z9, z10) = z in
  let m11 = dl1**2.0*.dm1*.z1**2.0*.z7*.sin(dq1*.z4 +. q1)**2.0/.4.0 +. dl1**2.0*.dm1*.z1**2.0*.z7*.cos(dq1*.z4 +. q1)**2.0/.4.0 +. dl1**2.0*.dm1*.z1**2.0*.z7/.12.0 +. dl1**2.0*.dm2*.z1**2.0*.z8*.sin(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.dm2*.z1**2.0*.z8*.cos(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.dm3*.z1**2.0*.z9*.sin(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.dm3*.z1**2.0*.z9*.cos(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.dm4*.z1**2.0*.z10*.sin(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.dm4*.z1**2.0*.z10*.cos(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.m1*.z1**2.0*.sin(dq1*.z4 +. q1)**2.0/.4.0 +. dl1**2.0*.m1*.z1**2.0*.cos(dq1*.z4 +. q1)**2.0/.4.0 +. dl1**2.0*.m1*.z1**2.0/.12.0 +. dl1**2.0*.m2*.z1**2.0*.sin(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.m2*.z1**2.0*.cos(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.m3*.z1**2.0*.sin(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.m3*.z1**2.0*.cos(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.m4*.z1**2.0*.sin(dq1*.z4 +. q1)**2.0 +. dl1**2.0*.m4*.z1**2.0*.cos(dq1*.z4 +. q1)**2.0 +. dl1*.dl2*.dm2*.z1*.z2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.dm2*.z1*.z2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.dm3*.z1*.z2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.dm3*.z1*.z2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.dm4*.z1*.z10*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.dm4*.z1*.z10*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m2*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m2*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.m3*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.m3*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.m4*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dl2*.m4*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl3*.dm3*.z1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.dm3*.z1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.dl3*.dm4*.z1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.dl3*.dm4*.z1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m3*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m3*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.dl3*.m4*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.dl3*.m4*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm1*.l1*.z1*.z7*.sin(dq1*.z4 +. q1)**2.0/.2.0 +. dl1*.dm1*.l1*.z1*.z7*.cos(dq1*.z4 +. q1)**2.0/.2.0 +. dl1*.dm1*.l1*.z1*.z7/.6.0 +. 2.0*.dl1*.dm2*.l1*.z1*.z8*.sin(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.dm2*.l1*.z1*.z8*.cos(dq1*.z4 +. q1)**2.0 +. dl1*.dm2*.l2*.z1*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm2*.l2*.z1*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dm3*.l1*.z1*.z9*.sin(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.dm3*.l1*.z1*.z9*.cos(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.dm3*.l2*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dm3*.l2*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm3*.l3*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm3*.l3*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.dm4*.l1*.z1*.z10*.sin(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.dm4*.l1*.z1*.z10*.cos(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.dm4*.l2*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dm4*.l2*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.dm4*.l3*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.dm4*.l3*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l1*.m1*.z1*.sin(dq1*.z4 +. q1)**2.0/.2.0 +. dl1*.l1*.m1*.z1*.cos(dq1*.z4 +. q1)**2.0/.2.0 +. dl1*.l1*.m1*.z1/.6.0 +. 2.0*.dl1*.l1*.m2*.z1*.sin(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.l1*.m2*.z1*.cos(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.l1*.m3*.z1*.sin(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.l1*.m3*.z1*.cos(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.l1*.m4*.z1*.sin(dq1*.z4 +. q1)**2.0 +. 2.0*.dl1*.l1*.m4*.z1*.cos(dq1*.z4 +. q1)**2.0 +. dl1*.l2*.m2*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l2*.m2*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.l2*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.l2*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.l2*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl1*.l2*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l3*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l3*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.l3*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl1*.l3*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2**2.0*.dm2*.z2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm2*.z2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m2*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m2*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m3*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m3*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm2*.l1*.z2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.dm2*.l1*.z2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.dm2*.l2*.z2*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.dm2*.l2*.z2*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. 2.0*.dl2*.dm3*.l1*.z2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm3*.l1*.z2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dm4*.l1*.z10*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm4*.l1*.z10*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l1*.m2*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l1*.m2*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.l1*.m3*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.l1*.m3*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.l1*.m4*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.l1*.m4*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l2*.m2*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.l2*.m2*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. 2.0*.dl2*.l2*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.dm4*.l1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l1*.m3*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l1*.m3*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l1*.m4*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l1*.m4*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm1*.l1**2.0*.z7*.sin(dq1*.z4 +. q1)**2.0/.4.0 +. dm1*.l1**2.0*.z7*.cos(dq1*.z4 +. q1)**2.0/.4.0 +. dm1*.l1**2.0*.z7/.12.0 +. dm2*.l1**2.0*.z8*.sin(dq1*.z4 +. q1)**2.0 +. dm2*.l1**2.0*.z8*.cos(dq1*.z4 +. q1)**2.0 +. dm2*.l1*.l2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm2*.l1*.l2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm2*.l2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm2*.l2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm3*.l1**2.0*.z9*.sin(dq1*.z4 +. q1)**2.0 +. dm3*.l1**2.0*.z9*.cos(dq1*.z4 +. q1)**2.0 +. 2.0*.dm3*.l1*.l2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dm3*.l1*.l2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm3*.l1*.l3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l1*.l3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l1**2.0*.z10*.sin(dq1*.z4 +. q1)**2.0 +. dm4*.l1**2.0*.z10*.cos(dq1*.z4 +. q1)**2.0 +. 2.0*.dm4*.l1*.l2*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dm4*.l1*.l2*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dm4*.l1*.l3*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dm4*.l1*.l3*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm4*.l2**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l1**2.0*.m1*.sin(dq1*.z4 +. q1)**2.0/.4.0 +. l1**2.0*.m1*.cos(dq1*.z4 +. q1)**2.0/.4.0 +. l1**2.0*.m1/.12.0 +. l1**2.0*.m2*.sin(dq1*.z4 +. q1)**2.0 +. l1**2.0*.m2*.cos(dq1*.z4 +. q1)**2.0 +. l1**2.0*.m3*.sin(dq1*.z4 +. q1)**2.0 +. l1**2.0*.m3*.cos(dq1*.z4 +. q1)**2.0 +. l1**2.0*.m4*.sin(dq1*.z4 +. q1)**2.0 +. l1**2.0*.m4*.cos(dq1*.z4 +. q1)**2.0 +. l1*.l2*.m2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l2*.m2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.l1*.l2*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.l1*.l2*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.l1*.l2*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.l1*.l2*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l3*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l1*.l3*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l1*.l3*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l1*.l3*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2**2.0*.m2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m12 = dl1*.dl2*.dm2*.z1*.z2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.dm2*.z1*.z2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.dm3*.z1*.z2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.dm3*.z1*.z2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.dm4*.z1*.z10*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.dm4*.z1*.z10*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m2*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.m2*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.m3*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m3*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m4*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m4*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl3*.dm3*.z1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm3*.z1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm4*.z1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.dm4*.z1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m3*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m3*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m4*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m4*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm2*.l2*.z1*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dm2*.l2*.z1*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dm3*.l2*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm3*.l2*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm3*.l3*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm3*.l3*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm4*.l2*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm4*.l2*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm4*.l3*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm4*.l3*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l2*.m2*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.l2*.m2*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.l2*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l2*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l2*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l2*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l3*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l3*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2**2.0*.dm2*.z2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm2*.z2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m2*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m2*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m3*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m3*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm2*.l1*.z2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.dm2*.l1*.z2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.dm2*.l2*.z2*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.dm2*.l2*.z2*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.dm3*.l1*.z2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.dm3*.l1*.z2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm4*.l1*.z10*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.dm4*.l1*.z10*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l1*.m2*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.l1*.m2*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.l1*.m3*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l1*.m3*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l1*.m4*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l1*.m4*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l2*.m2*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.l2*.m2*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. 2.0*.dl2*.l2*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm4*.l1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l1*.m3*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m3*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m4*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l1*.m4*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm2*.l1*.l2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dm2*.l1*.l2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dm2*.l2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm2*.l2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm3*.l1*.l2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm3*.l1*.l2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm3*.l1*.l3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l1*.l3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l1*.l2*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm4*.l1*.l2*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm4*.l1*.l3*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l1*.l3*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm4*.l2**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l1*.l2*.m2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. l1*.l2*.m2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. l1*.l2*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l2*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l2*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l2*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l3*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l1*.l3*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2**2.0*.m2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m13 = dl1*.dl3*.dm3*.z1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm3*.z1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm4*.z1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.dm4*.z1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m3*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m3*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m4*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m4*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm3*.l3*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm3*.l3*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm4*.l3*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm4*.l3*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l3*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l3*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm4*.l1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l1*.m3*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m3*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m4*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l1*.m4*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm3*.l1*.l3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l1*.l3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l1*.l3*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l1*.l3*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l1*.l3*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l1*.l3*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m21 = dl1*.dl2*.dm2*.z1*.z2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.dm2*.z1*.z2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.dm3*.z1*.z2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.dm3*.z1*.z2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.dm4*.z1*.z10*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.dm4*.z1*.z10*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m2*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.m2*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dl2*.m3*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m3*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m4*.z1*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl2*.m4*.z1*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dl3*.dm3*.z1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm3*.z1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm4*.z1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.dm4*.z1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m3*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m3*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m4*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m4*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm2*.l2*.z1*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dm2*.l2*.z1*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.dm3*.l2*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm3*.l2*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm3*.l3*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm3*.l3*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm4*.l2*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm4*.l2*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.dm4*.l3*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm4*.l3*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l2*.m2*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.l2*.m2*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl1*.l2*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l2*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l2*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l2*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl1*.l3*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l3*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2**2.0*.dm2*.z2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm2*.z2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m2*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m2*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m3*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m3*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm2*.l1*.z2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.dm2*.l1*.z2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.dm2*.l2*.z2*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.dm2*.l2*.z2*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.dm3*.l1*.z2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.dm3*.l1*.z2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm4*.l1*.z10*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.dm4*.l1*.z10*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l1*.m2*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.l1*.m2*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dl2*.l1*.m3*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l1*.m3*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l1*.m4*.z2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l1*.m4*.z2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dl2*.l2*.m2*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.l2*.m2*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. 2.0*.dl2*.l2*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm4*.l1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l1*.m3*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m3*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m4*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l1*.m4*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm2*.l1*.l2*.z8*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dm2*.l1*.l2*.z8*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. dm2*.l2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm2*.l2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm3*.l1*.l2*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm3*.l1*.l2*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm3*.l1*.l3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l1*.l3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l1*.l2*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm4*.l1*.l2*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. dm4*.l1*.l3*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l1*.l3*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm4*.l2**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l1*.l2*.m2*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. l1*.l2*.m2*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)/.2.0 +. l1*.l2*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l2*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l2*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l2*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2) +. l1*.l3*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l1*.l3*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2**2.0*.m2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m22 = dl2**2.0*.dm2*.z2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm2*.z2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.dm2*.z2**2.0*.z8/.12.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm3*.z2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.dm4*.z10*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m2*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m2*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dl2**2.0*.m2*.z2**2.0/.12.0 +. dl2**2.0*.m3*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m3*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2**2.0*.m4*.z2**2.0*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm2*.l2*.z2*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.dm2*.l2*.z2*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.dm2*.l2*.z2*.z8/.6.0 +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm3*.l2*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l2*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l2*.m2*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.l2*.m2*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.2.0 +. dl2*.l2*.m2*.z2/.6.0 +. 2.0*.dl2*.l2*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dl2*.l2*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm2*.l2**2.0*.z8*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm2*.l2**2.0*.z8*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. dm2*.l2**2.0*.z8/.12.0 +. dm3*.l2**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l2**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. dm4*.l2**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. 2.0*.dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l2**2.0*.m2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0/.4.0 +. l2**2.0*.m2/.12.0 +. l2**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)**2.0 +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m23 = dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m31 = dl1*.dl3*.dm3*.z1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm3*.z1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.dm4*.z1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.dm4*.z1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m3*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m3*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dl3*.m4*.z1*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dl3*.m4*.z1*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm3*.l3*.z1*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm3*.l3*.z1*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.dm4*.l3*.z1*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.dm4*.l3*.z1*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l3*.m3*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m3*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl1*.l3*.m4*.z1*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl1*.l3*.m4*.z1*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l1*.z3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l1*.z3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm4*.l1*.z10*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l1*.z10*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l1*.m3*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m3*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l1*.m4*.z3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l1*.m4*.z3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm3*.l1*.l3*.z9*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l1*.l3*.z9*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l1*.l3*.z10*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l1*.l3*.z10*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l1*.l3*.m3*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m3*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l1*.l3*.m4*.sin(dq1*.z4 +. q1)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l1*.l3*.m4*.cos(dq1*.z4 +. q1)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m32 = dl2*.dl3*.dm3*.z2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm3*.z2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.dm4*.z10*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.dm4*.z10*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m3*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m3*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dl3*.m4*.z2*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dl3*.m4*.z2*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm3*.l3*.z2*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm3*.l3*.z2*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.dm4*.l3*.z10*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.dm4*.l3*.z10*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m3*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m3*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl2*.l3*.m4*.z2*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl2*.l3*.m4*.z2*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l2*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l2*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm4*.l2*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.dm4*.l2*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l2*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dl3*.l2*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l2*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm3*.l2*.l3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l2*.l3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm4*.l2*.l3*.z10*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l2*.l3*.z10*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l2*.l3*.m3*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m3*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)/.2.0 +. l2*.l3*.m4*.sin(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l2*.l3*.m4*.cos(dq1*.z4 +. dq2*.z5 +. q1 +. q2)*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3) +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  let m33 = dl3**2.0*.dm3*.z3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.dm3*.z3**2.0*.z9/.12.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.dm4*.z10*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m3*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dl3**2.0*.m3*.z3**2.0/.12.0 +. dl3**2.0*.m4*.z3**2.0*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3**2.0*.m4*.z3**2.0*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.dm3*.l3*.z3*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.dm3*.l3*.z3*.z9/.6.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.dm4*.l3*.z10*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dl3*.l3*.m3*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.2.0 +. dl3*.l3*.m3*.z3/.6.0 +. 2.0*.dl3*.l3*.m4*.z3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. 2.0*.dl3*.l3*.m4*.z3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm3*.l3**2.0*.z9*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. dm3*.l3**2.0*.z9/.12.0 +. dm4*.l3**2.0*.z10*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. dm4*.l3**2.0*.z10*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m3*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0/.4.0 +. l3**2.0*.m3/.12.0 +. l3**2.0*.m4*.sin(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 +. l3**2.0*.m4*.cos(dq1*.z4 +. dq2*.z5 +. dq3*.z6 +. q1 +. q2 +. q3)**2.0 in
  M33 (m11, m12, m13, m21, m22, m23, m31, m32, m33)

let dynamic_manipulability q z =
  let j = jacobian_matrix q z in
  let m = inertia_matrix q z in
  sqrt (det_mat (matmul_mat (matmul_mat j (inv_mat (matmul_mat (trans_mat m) m))) (trans_mat j)))

let inv_mat_test1 =
  inv_mat (M33 (1., 0., 0., 0., 1., 0., 0., 0., 1.)) =
    M33 (1., 0., 0., 0., 1., 0., 0., 0., 1.)
let inv_mat_test2 =
  inv_mat (M33 (1., 0., 0., 0., 2., 0., 0., 0., 3.)) =
    M33 (1., 0., 0., 0., 1./.2., 0., 0., 0., 1./.3.)

let det_mat_test1 =
  let m = M22 (1., 0., 0., 1.) in
  det_mat m = 1.
let det_mat_test2 =
  let m = M22 (0., 0., 0., 1.) in
  det_mat m = 0.

let matmul_test1 =
  let m = M33 (1., 2., 3., 4., 5., 6., 7., 8., 9.) in
  matmul_mat m m = M33 (30., 36., 42., 66., 81., 96., 102., 126., 150.)
let matmul_test2 =
  let m = M33 (0., 0., 0., 0., 0., 0., 0., 0., 0.) in
  matmul_mat m m = M33 (0., 0., 0., 0., 0., 0., 0., 0., 0.)
let matmul_test3 =
  let m = M33 (1., 1., 1., 1., 1., 1., 1., 1., 1.) in
  matmul_mat m m = M33 (3., 3., 3., 3., 3., 3., 3., 3., 3.)
